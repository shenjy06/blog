name: Blog Deploy
on:
  push:
    branches:
      - master
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ðŸ›Žï¸
        uses: actions/checkout@v3

      - name: Install and Build ðŸ”§
        run: |
          npm install
          npm run clean
          npm run build

      - name: Deploy ðŸš€
        env:
          # Github ä»“åº“
          GITHUB_REPO: github.com/MarkShen1992/markshen1992.github.io
        # å°†ç¼–è¯‘åŽçš„åšå®¢æ–‡ä»¶æŽ¨é€åˆ°æŒ‡å®šä»“åº“
        run: |
          cp theme/cactus/LICENSE public/
          cp README.md public/
          cd ./public
          echo "markshen1992.top" > CNAME
          git init
          git config user.name "shenjunyu"
          git config user.email "18009838166@163.com"
          git add .
          git commit -m "GitHub Actions Auto Builder at $(date +'%Y-%m-%d')"
          git branch -M main
          git push --force --quiet "https://${{ secrets.ACCESS_TOKEN }}@$GITHUB_REPO" main:main
