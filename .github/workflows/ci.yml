name: Blog Deploy
on:
  push:
    branches:
      - master
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout 🛎️
        uses: actions/checkout@v3

      - name: Install and Build 🔧
        run: |
          npm install
          npm run clean
          npm run build

      - name: Deploy 🚀
        env:
          # Github 仓库
          GITHUB_REPO: github.com/MarkShen1992/markshen1992.github.io
        # 将编译后的博客文件推送到指定仓库
        run: |
          cd ./public
          git init
          git config user.name "shenjunyu"
          git config user.email "18009838166@163.com"
          git add .
          git commit -m "GitHub Actions Auto Builder at $(date +'%Y-%m-%d %H:%M:%S')"
          git push --force --quiet "https://${{ secrets.ACCESS_TOKEN }}@$GITHUB_REPO" main:main
